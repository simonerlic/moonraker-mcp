services:
    moonraker-mcp:
        build: .
        ports:
            - "8000:8000"
        env_file:
            - path: ./.env
              required: true
        restart: unless-stopped
        networks:
            - mcp-network

    cloudflared:
        image: cloudflare/cloudflared:latest
        command: tunnel --config /etc/cloudflared/config.yml run
        volumes:
            - ./cloudflared/config.yml:/etc/cloudflared/config.yml:ro
            - ./cloudflared/cert.pem:/etc/cloudflared/cert.pem:ro
        restart: unless-stopped
        depends_on:
            - moonraker-mcp
        networks:
            - mcp-network

networks:
    mcp-network:
        driver: bridge
